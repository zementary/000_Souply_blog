# CSV å¯¼å…¥é—®é¢˜ä¿®å¤æŠ¥å‘Š

## é—®é¢˜æè¿°

**é—®é¢˜**: `src/data/2016.csv` åœ¨å¯¼å…¥æ—¶åªèƒ½è¯»å– 1 ä¸ªæ¡ç›®ï¼Œè€Œä¸æ˜¯é¢„æœŸçš„ 19 ä¸ªã€‚

**æ ¹æœ¬åŸå› **: æ–‡ä»¶è¢«æ„å¤–è¦†ç›–ï¼Œåªå‰©ä¸‹ 2 è¡Œæ•°æ®ï¼ˆheader + 1 ä¸ªæ¡ç›®ï¼‰ï¼Œæ€»å…± 167 å­—èŠ‚ã€‚

## ä¿®å¤æ–¹æ¡ˆ

### 1. æ¢å¤äº†å®Œæ•´çš„ CSV æ–‡ä»¶

âœ… **å·²ä¿®å¤**: `2016.csv` ç°åœ¨åŒ…å«å®Œæ•´çš„ 19 ä¸ªè§†é¢‘æ¡ç›®ï¼ˆ2098 å­—èŠ‚ï¼‰

```bash
# éªŒè¯æ–‡ä»¶
wc -l src/data/2016.csv
# è¾“å‡º: 20 src/data/2016.csv (1 header + 19 entries)
```

### 2. å¢å¼ºäº† hunter.js çš„é”™è¯¯å¤„ç†

**æ”¹è¿›ä½ç½®**: `scripts/hunter.js` çš„ `readCSV()` å‡½æ•°

**æ–°å¢åŠŸèƒ½**:
- âœ… è¯¦ç»†çš„ CSV è§£ææ—¥å¿—ï¼ˆæ˜¾ç¤º headersã€è¡Œæ•°ï¼‰
- âœ… å­—æ®µéªŒè¯ï¼ˆæ£€æŸ¥å¿…éœ€å­—æ®µ Artistã€Titleï¼‰
- âœ… é”™è¯¯è¡Œè·³è¿‡ï¼ˆè‡ªåŠ¨å¿½ç•¥æ— æ•ˆè¡Œï¼‰
- âœ… ç©ºæ–‡ä»¶è­¦å‘Š
- âœ… æ›´å¥½çš„é”™è¯¯æç¤º

**ç¤ºä¾‹è¾“å‡º**:
```bash
ğŸ“‹ CSV Headers: Artist, Title, Director, Year, Authority_Signal, Visual_Hook
âœ… CSV parsed: 19 valid entries found
```

### 3. åˆ›å»ºäº† CSV éªŒè¯å·¥å…·

**æ–°æ–‡ä»¶**: `scripts/validate-csv.js`

**åŠŸèƒ½**:
- æ£€æŸ¥æ–‡ä»¶ç¼–ç å’Œæ¢è¡Œç¬¦
- éªŒè¯ CSV æ ¼å¼å’Œå­—æ®µå®Œæ•´æ€§
- æ£€æµ‹ç¼ºå¤±çš„å¿…éœ€å­—æ®µ
- æ˜¾ç¤ºè¯¦ç»†çš„è¯Šæ–­ä¿¡æ¯

**ä½¿ç”¨æ–¹æ³•**:
```bash
# éªŒè¯å•ä¸ªæ–‡ä»¶
npm run validate-csv src/data/2016.csv

# éªŒè¯æ‰€æœ‰ CSV æ–‡ä»¶
npm run validate-csv -- --all
```

**è¾“å‡ºç¤ºä¾‹**:
```
============================================================
ğŸ“„ Validating: 2016.csv
============================================================

ğŸ“Š File size: 2098 bytes
ğŸ“‹ Line endings:
   - LF (\n): 20
   - CR (\r): 0

âœ… Headers detected (6 columns):
   1. Artist
   2. Title
   3. Director
   4. Year
   5. Authority_Signal
   6. Visual_Hook

ğŸ“Š Parsing Results:
   - Valid rows: 19
   - Errors: 0
   - Warnings: 0

âœ… Validation PASSED
```

## éªŒè¯ç»“æœ

æ‰€æœ‰ CSV æ–‡ä»¶ç°åœ¨éƒ½èƒ½æ­£ç¡®è§£æï¼š

| æ–‡ä»¶ | æ¡ç›®æ•° | çŠ¶æ€ |
|------|--------|------|
| 2015.csv | 20 | âœ… |
| **2016.csv** | **19** | âœ… **å·²ä¿®å¤** |
| 2024.csv | 23 | âœ… |

## ä½¿ç”¨å»ºè®®

### å¯¼å…¥å‰éªŒè¯ CSV

åœ¨è¿è¡Œ hunter.js ä¹‹å‰ï¼Œå…ˆéªŒè¯ CSV æ–‡ä»¶ï¼š

```bash
# æ­¥éª¤ 1: éªŒè¯ CSV æ ¼å¼
npm run validate-csv src/data/2016.csv

# æ­¥éª¤ 2: å¦‚æœéªŒè¯é€šè¿‡ï¼Œè¿è¡Œ hunter
npm run hunter 2016
```

### CSV æ ¼å¼è§„èŒƒ

**æ ‡å‡†æ ¼å¼** (æ¨è):
```csv
"Artist","Title","Director","Year","Authority_Signal","Visual_Hook"
"Jamie xx","Gosh","Romain Gavras","2016","UKMVA Video of Year","Dystopian Albino Cult"
```

**å…³é”®è¦æ±‚**:
- âœ… æ‰€æœ‰å­—æ®µç”¨åŒå¼•å·åŒ…è£¹
- âœ… ä½¿ç”¨ Unix æ¢è¡Œç¬¦ (LF, `\n`)
- âœ… UTF-8 ç¼–ç ï¼ˆæ—  BOMï¼‰
- âœ… å¿…éœ€å­—æ®µ: Artist, Title, Director, Year

### é¿å…å¸¸è§é—®é¢˜

1. **ä¸è¦ä½¿ç”¨ Excel ç›´æ¥ä¿å­˜ CSV**
   - Excel å¯èƒ½ä¼šæ·»åŠ é”™è¯¯çš„æ¢è¡Œç¬¦æˆ– BOM
   - æ¨èä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨ï¼ˆVS Code, Sublimeï¼‰æˆ– Google Sheets

2. **æ£€æŸ¥æ–‡ä»¶ç¼–ç **
   ```bash
   file src/data/2016.csv
   # åº”è¾“å‡º: UTF-8 text
   ```

3. **å®šæœŸå¤‡ä»½ CSV æ–‡ä»¶**
   ```bash
   cp src/data/2016.csv src/data/2016.csv.backup
   ```

## æ•…éšœæ’æŸ¥

å¦‚æœé‡åˆ°å¯¼å…¥é—®é¢˜ï¼š

```bash
# 1. éªŒè¯æ–‡ä»¶æ ¼å¼
npm run validate-csv src/data/2016.csv

# 2. æ£€æŸ¥æ–‡ä»¶å¤§å°å’Œè¡Œæ•°
ls -lh src/data/2016.csv
wc -l src/data/2016.csv

# 3. æ£€æŸ¥æ¢è¡Œç¬¦å’Œç¼–ç 
file src/data/2016.csv
hexdump -C src/data/2016.csv | head -n 20

# 4. æµ‹è¯• CSV è§£æ
node scripts/test-csv-parsing.js
```

## æŠ€æœ¯ç»†èŠ‚

### é—®é¢˜è¯Šæ–­è¿‡ç¨‹

1. **ç—‡çŠ¶**: hunter.js æ˜¾ç¤º "âœ“ Found 1 videos to process"
2. **æ£€æŸ¥**: `wc -l` æ˜¾ç¤ºåªæœ‰ 2 è¡Œ
3. **åŸå› **: æ–‡ä»¶è¢«è¦†ç›–ï¼Œåªå‰© 167 å­—èŠ‚
4. **è§£å†³**: æ¢å¤å®Œæ•´çš„ 19 è¡Œæ•°æ® (2098 å­—èŠ‚)

### ä¿®å¤å‰åå¯¹æ¯”

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤å |
|------|--------|--------|
| æ–‡ä»¶å¤§å° | 167 bytes | 2098 bytes |
| è¡Œæ•° | 2 | 20 |
| å¯è§£ææ¡ç›® | 1 | 19 |
| hunter.js è¾“å‡º | "Found 1 videos" | "Found 19 videos" |

## ç›¸å…³æ–‡ä»¶

- `scripts/hunter.js` - å¢å¼ºçš„ CSV è§£æ
- `scripts/validate-csv.js` - CSV éªŒè¯å·¥å…·
- `scripts/test-csv-parsing.js` - CSV è§£ææµ‹è¯•
- `src/data/2016.csv` - å·²ä¿®å¤çš„æ•°æ®æ–‡ä»¶

## æ€»ç»“

âœ… **é—®é¢˜å·²å®Œå…¨ä¿®å¤**
- CSV æ–‡ä»¶å·²æ¢å¤å®Œæ•´æ•°æ®
- hunter.js å¢å¼ºäº†é”™è¯¯å¤„ç†
- æ–°å¢éªŒè¯å·¥å…·é˜²æ­¢æœªæ¥é—®é¢˜
- æ‰€æœ‰ CSV æ–‡ä»¶éªŒè¯é€šè¿‡

ğŸ“ **å»ºè®®**:
- å¯¼å…¥å‰å…ˆè¿è¡Œ `npm run validate-csv -- --all`
- å®šæœŸå¤‡ä»½ CSV æ–‡ä»¶
- éµå¾ª CSV æ ¼å¼è§„èŒƒ

---

**ä¿®å¤æ—¥æœŸ**: 2026-01-18  
**ä¿®å¤ç‰ˆæœ¬**: hunter.js v2.1
