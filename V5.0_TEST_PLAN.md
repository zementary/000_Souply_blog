# ğŸ§ª Ingest V5.0 - å¿«é€Ÿæµ‹è¯•è®¡åˆ’

## ğŸ“‹ æµ‹è¯•å‰å‡†å¤‡

### 1. ç¡®è®¤ Clash Verge ä»£ç†è¿è¡Œä¸­
```bash
# æ£€æŸ¥ä»£ç†ç«¯å£æ˜¯å¦å¼€æ”¾
curl -x http://127.0.0.1:7897 https://www.google.com
```

### 2. æ¸…ç†æ—§æ•°æ®ï¼ˆå¯é€‰ï¼‰
```bash
# å¤‡ä»½ç°æœ‰è§†é¢‘æ–‡ä»¶
cp -r src/content/videos src/content/videos.backup.$(date +%Y%m%d)

# åˆ é™¤ç‰¹å®šå¹´ä»½çš„æ–‡ä»¶å‡†å¤‡é‡æ–°å¯¼å…¥
rm -f src/content/videos/2016-*.mdx
```

---

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•

### Test 1: å•ä¸ªè§†é¢‘å¯¼å…¥ï¼ˆåŸºç¡€æµ‹è¯•ï¼‰

**æµ‹è¯•è§†é¢‘ï¼š** BeyoncÃ© - Formation
```bash
npm run ingest "https://www.youtube.com/watch?v=WAKP3trj5iY"
```

**é¢„æœŸç»“æœï¼š**
```yaml
âœ… æ—¥å¿—åº”æ˜¾ç¤ºï¼š
   ğŸ” Proxy enabled: http://127.0.0.1:7897
   ğŸª Attempting with Brave cookies...
   âœ… Successfully fetched with Brave cookies
   
âœ… ç”Ÿæˆçš„ MDX æ–‡ä»¶åº”åŒ…å«ï¼š
   - director: "Melina Matsoukas" (æˆ–å…¶ä»–å¯¼æ¼”)
   - tags: [è‡³å°‘æœ‰ä¸€ä¸ªæœ‰æ„ä¹‰çš„æ ‡ç­¾ï¼Œä¸åº”è¯¥æ˜¯ "uncategorized"]
   
âŒ ä¸åº”è¯¥å‡ºç°ï¼š
   - editor: ...
   - dop: ...
   - art_director: ...
   - vfx: ...
```

---

### Test 2: å¯¼æ¼”è¯†åˆ«æµ‹è¯•ï¼ˆæ™ºèƒ½è§£æï¼‰

**æµ‹è¯•è§†é¢‘ï¼š** Massive Attack - Voodoo In My Blood
```bash
npm run ingest "https://www.youtube.com/watch?v=ElvLZMsYXlo"
```

**éªŒè¯ç‚¹ï¼š**
```
âœ… å¦‚æœæè¿°ä¸­æœ‰ "Written and Produced by Robert Del Naja"
   åº”è¯†åˆ«ä¸ºï¼šdirector: "Robert Del Naja"
   
âŒ ä¸åº”è¯¥æ”¾è¿›ï¼šproduction_company
```

---

### Test 3: URL æˆªæ–­ä¿®å¤æµ‹è¯•

**æµ‹è¯•è§†é¢‘ï¼š** The Chemical Brothers - Wide Open
```bash
npm run ingest "https://www.youtube.com/watch?v=BC2dRkm8ATU"
```

**éªŒè¯ç‚¹ï¼š**
```
âœ… director: "Dom & Nic" (å®Œæ•´åå­—)
âŒ director: "Dom & Nic http://www" (æˆªæ–­é—®é¢˜)
```

---

### Test 4: è‰ºæœ¯å®¶åå»é‡æµ‹è¯•

**æµ‹è¯•è§†é¢‘ï¼š** ä»»ä½•è‰ºæœ¯å®¶ååœ¨æ ‡é¢˜ä¸­é‡å¤çš„è§†é¢‘

**éªŒè¯ç‚¹ï¼š**
```
åŸå§‹æ ‡é¢˜: "Massive Attack, Young Fathers - Voodoo In My Blood"
âœ… åº”æ¸…ç†ä¸º: title: "Voodoo In My Blood"
âœ… è‰ºæœ¯å®¶: artist: "Massive Attack" (æ­£ç¡®å¤§å°å†™)
```

---

### Test 5: æ‰¹é‡å¯¼å…¥æµ‹è¯•ï¼ˆå¸¦è‡ªåŠ¨æ ‡ç­¾ï¼‰

**å‡†å¤‡ CSV æ–‡ä»¶ï¼š** `src/data/2016-test.csv`
```csv
Artist,Title,Director,Year,Authority_Signal,Visual_Hook
BeyoncÃ©,Formation,Melina Matsoukas,2016,100,Political Imagery
Radiohead,Burn The Witch,Chris Hopewell,2016,95,Stop-Motion Animation
Coldplay,Up&Up,Vania Heymann,2016,90,Surreal Collage
```

**æ‰§è¡Œæ‰¹é‡å¯¼å…¥ï¼š**
```bash
npm run hunter 2016-test
```

**é¢„æœŸç»“æœï¼š**
```
âœ… æ‰€æœ‰è§†é¢‘åº”æœ‰ Visual Hook è½¬æ¢çš„æ ‡ç­¾
âœ… éšæœºå»¶è¿Ÿåº”åœ¨ 2-7 ç§’ä¹‹é—´ï¼ˆæ—¥å¿—æ˜¾ç¤º "â³ Waiting 4.2s (jitter)..."ï¼‰
âœ… æ¯ä¸ªè§†é¢‘åªæœ‰ 3 ä¸ªå­—æ®µï¼šdirector, production_company, label
```

---

## ğŸ” å­—æ®µéªŒè¯æ¸…å•

### å¯¹äºæ¯ä¸ªç”Ÿæˆçš„ MDX æ–‡ä»¶ï¼Œæ£€æŸ¥ï¼š

#### âœ… åº”è¯¥å­˜åœ¨çš„å­—æ®µï¼š
- [ ] `title` - å¹²å‡€çš„æ ‡é¢˜ï¼ˆæ— è‰ºæœ¯å®¶åé‡å¤ï¼‰
- [ ] `artist` - æ­£ç¡®çš„è‰ºæœ¯å®¶åï¼ˆå¤§å°å†™è§„èŒƒï¼‰
- [ ] `video_url` - å®Œæ•´çš„ YouTube URL
- [ ] `publishDate` - YYYY-MM-DD æ ¼å¼
- [ ] `cover` - å°é¢å›¾ç‰‡è·¯å¾„
- [ ] `curator_note` - ç©ºå­—ç¬¦ä¸²æˆ–æœ‰å†…å®¹
- [ ] `tags` - è‡³å°‘æœ‰ä¸€ä¸ªæ ‡ç­¾ï¼ˆéç©ºæ•°ç»„ï¼‰

#### âœ… å¯é€‰ä½†é«˜è´¨é‡çš„å­—æ®µï¼š
- [ ] `director` - å®Œæ•´åå­—ï¼ˆæ—  URLã€æ— æˆªæ–­ï¼‰
- [ ] `production_company` - å…¬å¸åï¼ˆä¸æ˜¯äººåï¼‰
- [ ] `label` - å”±ç‰‡å…¬å¸å

#### âŒ ä¸åº”è¯¥å­˜åœ¨çš„å­—æ®µï¼ˆV5.0 å·²ç§»é™¤ï¼‰ï¼š
- [ ] `editor`
- [ ] `dop`
- [ ] `art_director`
- [ ] `vfx`
- [ ] `sound_design`
- [ ] `colorist`

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜ 1: Brave Cookie å¤±è´¥
```
âš ï¸  Brave Cookie è¯»å–å¤±è´¥ï¼Œå°è¯•æ—  Cookie æ¨¡å¼...
```
**è§£å†³æ–¹æ¡ˆï¼š** è¿™æ˜¯æ­£å¸¸é™çº§è¡Œä¸ºï¼Œè„šæœ¬ä¼šè‡ªåŠ¨å›é€€åˆ°æ—  Cookie æ¨¡å¼ã€‚

---

### é—®é¢˜ 2: ä»£ç†è¿æ¥å¤±è´¥
```
Error: connect ECONNREFUSED 127.0.0.1:7897
```
**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ Clash Verge æ˜¯å¦è¿è¡Œ
2. éªŒè¯ä»£ç†ç«¯å£æ˜¯å¦ä¸º 7897
3. å°è¯•æ‰‹åŠ¨è®¾ç½®ä»£ç†ï¼š
   ```bash
   export HTTPS_PROXY=http://127.0.0.1:7897
   npm run ingest "https://..."
   ```

---

### é—®é¢˜ 3: æ ‡ç­¾ä¸º "uncategorized"
```yaml
tags: ["uncategorized"]
```
**åŸå› ï¼š**
- æ²¡æœ‰ä» hunter.js ä¼ å…¥æ ‡ç­¾
- æ²¡æœ‰æ‰¾åˆ°å¯¼æ¼”ä¿¡æ¯
- è§†é¢‘å…ƒæ•°æ®ä¸è¶³

**è§£å†³æ–¹æ¡ˆï¼š**
- ä½¿ç”¨ `npm run hunter` æ‰¹é‡å¯¼å…¥ï¼ˆè‡ªåŠ¨æ³¨å…¥ Visual Hook æ ‡ç­¾ï¼‰
- æ‰‹åŠ¨ç¼–è¾‘ MDX æ–‡ä»¶æ·»åŠ æ ‡ç­¾
- æ£€æŸ¥è§†é¢‘æè¿°æ˜¯å¦æœ‰å¯¼æ¼”ä¿¡æ¯

---

### é—®é¢˜ 4: å¯¼æ¼”å­—æ®µä¸ºç©º
```yaml
# director å­—æ®µç¼ºå¤±
```
**åŸå› ï¼š** è§†é¢‘æè¿°ä¸­æ²¡æœ‰æ ‡å‡†çš„å¯¼æ¼”æ ¼å¼

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ£€æŸ¥ YouTube æè¿°æ˜¯å¦åŒ…å« "Directed by" æˆ– "Director:"
2. æ‰‹åŠ¨æ·»åŠ å¯¼æ¼”å­—æ®µï¼š
   ```yaml
   director: "Unknown Director"
   ```
3. å¦‚æœæ˜¯è‰ºæœ¯å®¶æœ¬äººåˆ¶ä½œï¼Œæ£€æŸ¥æ˜¯å¦æœ‰ "Written and Produced by"

---

## ğŸ“Š è´¨é‡è¯„åˆ†æ ‡å‡†

### A çº§ï¼ˆå®Œç¾å¯¼å…¥ï¼‰
- âœ… Director å­—æ®µå®Œæ•´å‡†ç¡®
- âœ… Production Company æˆ– Label å­˜åœ¨
- âœ… è‡³å°‘ 2 ä¸ªæœ‰æ„ä¹‰çš„æ ‡ç­¾
- âœ… æ ‡é¢˜å¹²å‡€æ— å†—ä½™
- âœ… è‰ºæœ¯å®¶åå¤§å°å†™æ­£ç¡®

### B çº§ï¼ˆè‰¯å¥½å¯¼å…¥ï¼‰
- âœ… Director å­—æ®µå­˜åœ¨
- âš ï¸ ç¼ºå°‘ Production Company/Label
- âœ… è‡³å°‘ 1 ä¸ªæ ‡ç­¾
- âœ… æ ‡é¢˜åŸºæœ¬å¹²å‡€

### C çº§ï¼ˆéœ€è¦æ‰‹åŠ¨ä¿®å¤ï¼‰
- âŒ Director å­—æ®µç¼ºå¤±
- âŒ æ ‡ç­¾ä¸º "uncategorized"
- âš ï¸ æ ‡é¢˜æœ‰å†—ä½™ä¿¡æ¯

---

## ğŸ¯ æµ‹è¯•é€šè¿‡æ ‡å‡†

### å¿…é¡»é€šè¿‡ï¼ˆCriticalï¼‰
- [ ] æ‰€æœ‰ç”Ÿæˆçš„ MDX æ–‡ä»¶ä¸åŒ…å«åºŸå¼ƒå­—æ®µï¼ˆeditor, dop, art_director, vfxï¼‰
- [ ] æ ‡é¢˜ä¸­ä¸å‡ºç°è‰ºæœ¯å®¶åé‡å¤
- [ ] Director å­—æ®µä¸è¢« URL æˆªæ–­
- [ ] Proxy å’Œ Cookie ç³»ç»Ÿæ­£å¸¸å·¥ä½œ

### åº”è¯¥é€šè¿‡ï¼ˆImportantï¼‰
- [ ] 80% çš„è§†é¢‘æœ‰ director å­—æ®µ
- [ ] 50% çš„è§†é¢‘æœ‰ production_company æˆ– label
- [ ] 90% çš„è§†é¢‘æœ‰è‡³å°‘ 1 ä¸ªé "uncategorized" çš„æ ‡ç­¾

### å»ºè®®é€šè¿‡ï¼ˆNice to Haveï¼‰
- [ ] Production company ä¸åŒ…å«äººå
- [ ] æ‰€æœ‰è‰ºæœ¯å®¶åå¤§å°å†™è§„èŒƒ
- [ ] æ ‡é¢˜å®Œå…¨å¹²å‡€ï¼ˆæ—  MV åç¼€ï¼‰

---

## ğŸš€ æ‰¹é‡æµ‹è¯•è„šæœ¬

```bash
#!/bin/bash
# test-v5.sh - V5.0 ç³»ç»Ÿæµ‹è¯•è„šæœ¬

echo "ğŸ§ª Starting Ingest V5.0 Tests..."

# Test 1: Basic ingestion
echo "Test 1: Basic Ingestion"
npm run ingest "https://www.youtube.com/watch?v=WAKP3trj5iY" -- --force

# Test 2: URL truncation fix
echo "Test 2: URL Truncation Fix"
npm run ingest "https://www.youtube.com/watch?v=BC2dRkm8ATU" -- --force

# Test 3: Artist as director
echo "Test 3: Artist as Director Detection"
npm run ingest "https://www.youtube.com/watch?v=ElvLZMsYXlo" -- --force

echo "âœ… All tests completed. Check output files in src/content/videos/"
```

---

**ç‰ˆæœ¬ï¼š** V5.0  
**æœ€åæ›´æ–°ï¼š** 2026-01-18
